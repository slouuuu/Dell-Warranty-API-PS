    function Get-DellWarrantyInfo {
        Param(
            [String] $ServiceTag
        )
    
        try {
            # Hardcoded API Key and Secret :D
            $ApiKey = "ApiKey"
            $ApiSecret = "ApiSecret"
        
            # Configure TLS and authenticate
            [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
            $Auth = Invoke-WebRequest "https://apigtwb2c.us.dell.com/auth/oauth/v2/token?client_id=${ApiKey}&client_secret=${ApiSecret}&grant_type=client_credentials" -Method Post
            $AuthSplit = $Auth.Content -split('"')
            $AuthKey = $AuthSplit[3]
        
            # Get warranty info
            $body = "?servicetags=" + $ServiceTag + "&Method=Get"
            $response = Invoke-WebRequest -uri https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements${body} -Headers @{"Authorization"="bearer ${AuthKey}";"Accept"="application/json"}
            $content = $response.Content | ConvertFrom-Json
        
            # Parse warranty information
            $sortedEntitlements = $content.entitlements | Sort-Object endDate
            if ($sortedEntitlements) {
                $WarrantyEndDateRaw = (($sortedEntitlements.endDate | Select-Object -Last 1).split("T"))[0]
                $WarrantyEndDate = [datetime]::ParseExact($WarrantyEndDateRaw, "yyyy-MM-dd", $null)
                $WarrantyStartDateRaw = (($sortedEntitlements.startDate | Select-Object -First 1).split("T"))[0]
                $WarrantyStartDate = [datetime]::ParseExact($WarrantyStartDateRaw, "yyyy-MM-dd", $null)
                $WarrantySupportLevel = ($sortedEntitlements.serviceLevelDescription | Select-Object -Last 1)
                
                if ($content.systemDescription) {
                    $ModelName = $content.systemDescription
                } else {
                    $ModelName = $content.productLineDescription
                }
            
                # expired warranty check
                $Today = Get-Date
                $IsWarrantyExpired = ($Today -ge $WarrantyEndDate)
                
                return @{
                    "ServiceTag" = $ServiceTag
                    "Model" = $ModelName
                    "WarrantyStart" = $WarrantyStartDate
                    "WarrantyEnd" = $WarrantyEndDate
                    "SupportLevel" = $WarrantySupportLevel
                    "IsExpired" = $IsWarrantyExpired
                }
            } else {
                return @{
                    "ServiceTag" = $ServiceTag
                    "Model" = "Unknown"
                    "WarrantyStart" = "Unknown"
                    "WarrantyEnd" = "Unknown"
                    "SupportLevel" = "Unknown"
                    "IsExpired" = "Unknown"
                }
            }
        } catch {
            return @{
                "ServiceTag" = $ServiceTag
                "Model" = "Error retrieving warranty information"
                "WarrantyStart" = "Unknown"
                "WarrantyEnd" = "Unknown"
                "SupportLevel" = "Unknown"
                "IsExpired" = "Unknown"
            }
        }
    }

    # Only get warranty info for Dell devices
    $WarrantyInfo = $null
    if ($Vendor -like "*Dell*") {
        $WarrantyInfo = Get-DellWarrantyInfo -ServiceTag $SerialNumber
    }
